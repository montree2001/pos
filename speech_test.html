<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏û‡∏π‡∏î - ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Speech Synthesis</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 20px;
            margin: 0;
            min-height: 100vh;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            padding: 30px;
            border-radius: 20px;
            max-width: 700px;
            margin: 0 auto;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }
        
        h1 {
            color: #e74c3c;
            margin-bottom: 30px;
        }
        
        .test-area {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px solid #dee2e6;
        }
        
        button {
            font-size: 1.1rem;
            padding: 12px 25px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s;
        }
        
        button:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }
        
        button:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }
        
        .success { background: #28a745; }
        .danger { background: #dc3545; }
        .warning { background: #ffc107; color: #212529; }
        
        textarea {
            width: 100%;
            height: 100px;
            padding: 10px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 14px;
            resize: vertical;
            font-family: Arial, sans-serif;
        }
        
        .status {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: bold;
        }
        
        .status.success { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
        .status.warning { background: #fff3cd; color: #856404; }
        .status.info { background: #d1ecf1; color: #0c5460; }
        
        .voice-selector {
            margin: 15px 0;
        }
        
        select {
            padding: 8px 12px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 14px;
            min-width: 200px;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        
        .slider-group {
            margin: 15px 0;
        }
        
        .slider-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input[type="range"] {
            width: 100%;
            margin: 5px 0;
        }
        
        .debug {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            text-align: left;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üó£Ô∏è ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏û‡∏π‡∏î Speech Synthesis</h1>
        
        <div class="test-area">
            <h3>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h3>
            <textarea id="testText" placeholder="‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö...">‡∏Ñ‡∏¥‡∏ß‡∏ó‡∏µ‡πà 1 ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏°‡∏≤‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏≤‡∏ô‡πå‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏Ñ‡∏£‡∏±‡∏ö</textarea>
            
            <div class="voice-selector">
                <label for="voiceSelect"><strong>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á:</strong></label>
                <select id="voiceSelect">
                    <option value="">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á...</option>
                </select>
            </div>
        </div>
        
        <div class="controls">
            <button onclick="initializeSpeech()" class="success">üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</button>
            <button onclick="speakText()" class="primary">üé§ ‡∏û‡∏π‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
            <button onclick="testThai()">üáπüá≠ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏ó‡∏¢</button>
            <button onclick="testEnglish()">üá∫üá∏ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©</button>
        </div>
        
        <div class="controls">
            <button onclick="loadVoicesForce()">üîÑ ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</button>
            <button onclick="testAllVoices()">üé≠ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á</button>
            <button onclick="stopSpeaking()" class="danger">‚èπÔ∏è ‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏π‡∏î</button>
            <button onclick="clearLog()">üóëÔ∏è ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå Log</button>
        </div>
        
        <div class="test-area">
            <h4>‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏á</h4>
            
            <div class="slider-group">
                <label for="volumeSlider">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á: <span id="volumeValue">100%</span></label>
                <input type="range" id="volumeSlider" min="0" max="100" value="100" oninput="updateVolume()">
            </div>
            
            <div class="slider-group">
                <label for="rateSlider">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß: <span id="rateValue">1.0x</span></label>
                <input type="range" id="rateSlider" min="0.1" max="2.0" step="0.1" value="1.0" oninput="updateRate()">
            </div>
            
            <div class="slider-group">
                <label for="pitchSlider">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á: <span id="pitchValue">1.0</span></label>
                <input type="range" id="pitchSlider" min="0.5" max="2.0" step="0.1" value="1.0" oninput="updatePitch()">
            </div>
        </div>
        
        <div id="status" class="status info">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö - ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö"</div>
        
        <div id="debug" class="debug">
            === LOG ===<br>
            ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô...
        </div>
    </div>

    <script>
        // Global variables
        let speechSynth = window.speechSynthesis;
        let voices = [];
        let selectedVoice = null;
        let isInitialized = false;
        let currentUtterance = null;
        
        // Settings
        let volume = 1.0;
        let rate = 1.0;
        let pitch = 1.0;
        
        // Debug
        let logs = [];

        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            logs.push(logEntry);
            
            if (logs.length > 30) {
                logs = logs.slice(-30);
            }
            
            document.getElementById('debug').innerHTML = 
                '=== LOG ===<br>' + logs.join('<br>');
            
            console.log(logEntry);
        }

        function showStatus(message, type = 'info') {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.className = `status ${type}`;
            log(`STATUS [${type}]: ${message}`);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            log('‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à');
            showStatus('‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö - ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö"', 'info');
            
            // Try to load voices immediately
            setTimeout(loadVoicesForce, 500);
        });

        function initializeSpeech() {
            log('‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö Speech Synthesis');
            showStatus('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö...', 'info');
            
            try {
                // Check browser support
                if (!('speechSynthesis' in window)) {
                    throw new Error('‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Speech Synthesis');
                }
                
                log('‚úÖ ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Speech Synthesis');
                
                // Cancel any ongoing speech
                speechSynth.cancel();
                log('‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏π‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà');
                
                // Force wake up
                const wakeUp = new SpeechSynthesisUtterance('');
                speechSynth.speak(wakeUp);
                speechSynth.cancel();
                log('‡∏õ‡∏•‡∏∏‡∏Å‡∏£‡∏∞‡∏ö‡∏ö Speech Synthesis');
                
                // Load voices
                loadVoicesForce();
                
                isInitialized = true;
                showStatus('‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô!', 'success');
                log('‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô');
                
            } catch (error) {
                log('‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
                showStatus('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
            }
        }

        function loadVoicesForce() {
            log('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á...');
            
            function getVoices() {
                voices = speechSynth.getVoices();
                log(`‡∏û‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á ${voices.length} ‡πÄ‡∏™‡∏µ‡∏¢‡∏á`);
                
                if (voices.length === 0) {
                    log('‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á - ‡∏£‡∏≠...');
                    return false;
                }
                
                // Update voice selector
                updateVoiceSelector();
                
                // Select best voice
                selectBestVoice();
                
                return true;
            }
            
            // Try immediately
            if (!getVoices()) {
                // Listen for voices changed
                speechSynth.addEventListener('voiceschanged', () => {
                    log('‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á');
                    getVoices();
                });
                
                // Force load voices
                setTimeout(() => {
                    log('‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á...');
                    speechSynth.speak(new SpeechSynthesisUtterance(''));
                    speechSynth.cancel();
                    setTimeout(getVoices, 100);
                }, 1000);
            }
        }

        function updateVoiceSelector() {
            const select = document.getElementById('voiceSelect');
            select.innerHTML = '';
            
            if (voices.length === 0) {
                select.innerHTML = '<option value="">‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á</option>';
                return;
            }
            
            voices.forEach((voice, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${voice.name} (${voice.lang})`;
                select.appendChild(option);
            });
            
            log(`‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï voice selector: ${voices.length} ‡πÄ‡∏™‡∏µ‡∏¢‡∏á`);
        }

        function selectBestVoice() {
            if (voices.length === 0) {
                log('‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å');
                return;
            }
            
            // Find Thai voice
            const thaiVoice = voices.find(voice => 
                voice.lang.includes('th') || 
                voice.lang.includes('TH') ||
                voice.name.includes('Thai') ||
                voice.name.includes('‡∏Å‡∏±‡∏ô‡∏¢‡∏≤')
            );
            
            if (thaiVoice) {
                selectedVoice = thaiVoice;
                log(`‚úÖ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÑ‡∏ó‡∏¢: ${thaiVoice.name}`);
                
                // Update selector
                const voiceIndex = voices.findIndex(v => v === thaiVoice);
                document.getElementById('voiceSelect').value = voiceIndex;
            } else {
                selectedVoice = voices[0];
                log(`‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÑ‡∏ó‡∏¢ ‡πÉ‡∏ä‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏£‡∏Å: ${voices[0].name}`);
                document.getElementById('voiceSelect').value = 0;
            }
        }

        // Voice selector change
        document.getElementById('voiceSelect').addEventListener('change', function() {
            const index = parseInt(this.value);
            if (index >= 0 && index < voices.length) {
                selectedVoice = voices[index];
                log(`‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏õ‡πá‡∏ô: ${selectedVoice.name}`);
            }
        });

        function speakText() {
            const text = document.getElementById('testText').value.trim();
            
            if (!text) {
                showStatus('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°', 'warning');
                return;
            }
            
            if (!isInitialized) {
                showStatus('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô', 'warning');
                return;
            }
            
            speak(text);
        }

        function speak(text, lang = 'th-TH') {
            log(`üó£Ô∏è ‡∏û‡∏π‡∏î: "${text}"`);
            showStatus(`‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏π‡∏î: ${text.substring(0, 30)}...`, 'info');
            
            try {
                // Cancel any ongoing speech
                speechSynth.cancel();
                
                // Wait a bit after cancel
                setTimeout(() => {
                    const utterance = new SpeechSynthesisUtterance(text);
                    
                    // Set voice
                    if (selectedVoice) {
                        utterance.voice = selectedVoice;
                        log(`‡πÉ‡∏ä‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏á: ${selectedVoice.name}`);
                    } else {
                        log('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å');
                    }
                    
                    // Set properties
                    utterance.volume = volume;
                    utterance.rate = rate;
                    utterance.pitch = pitch;
                    utterance.lang = lang;
                    
                    log(`‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: volume=${volume}, rate=${rate}, pitch=${pitch}, lang=${lang}`);
                    
                    // Event listeners
                    utterance.onstart = () => {
                        log('‚úÖ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏π‡∏î');
                        showStatus('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏π‡∏î...', 'info');
                    };
                    
                    utterance.onend = () => {
                        log('‚úÖ ‡∏û‡∏π‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à');
                        showStatus('‡∏û‡∏π‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß', 'success');
                        currentUtterance = null;
                    };
                    
                    utterance.onerror = (event) => {
                        log(`‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${event.error}`);
                        showStatus(`‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${event.error}`, 'error');
                        currentUtterance = null;
                    };
                    
                    utterance.onpause = () => {
                        log('‚è∏Ô∏è ‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß');
                    };
                    
                    utterance.onresume = () => {
                        log('‚ñ∂Ô∏è ‡πÄ‡∏•‡πà‡∏ô‡∏ï‡πà‡∏≠');
                    };
                    
                    // Start speaking
                    currentUtterance = utterance;
                    speechSynth.speak(utterance);
                    log('‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏û‡∏π‡∏î...');
                    
                    // Timeout fallback
                    setTimeout(() => {
                        if (currentUtterance && !speechSynth.speaking) {
                            log('‚è∞ ‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤ - ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏π‡∏î');
                            speechSynth.cancel();
                            showStatus('‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤', 'warning');
                            currentUtterance = null;
                        }
                    }, 20000);
                    
                }, 100);
                
            } catch (error) {
                log(`‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏π‡∏î‡πÑ‡∏î‡πâ: ${error.message}`);
                showStatus(`‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏π‡∏î‡πÑ‡∏î‡πâ: ${error.message}`, 'error');
            }
        }

        function testThai() {
            speak('‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ ‡∏Ñ‡∏¥‡∏ß‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏∂‡πà‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏°‡∏≤‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå', 'th-TH');
        }

        function testEnglish() {
            speak('Hello, this is an English test. Queue number one, please come to the counter.', 'en-US');
        }

        function testAllVoices() {
            if (voices.length === 0) {
                showStatus('‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö', 'error');
                return;
            }
            
            log('‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î...');
            showStatus('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î...', 'info');
            
            let currentIndex = 0;
            
            function testNext() {
                if (currentIndex >= voices.length) {
                    log('‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à');
                    showStatus('‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à', 'success');
                    return;
                }
                
                const voice = voices[currentIndex];
                selectedVoice = voice;
                document.getElementById('voiceSelect').value = currentIndex;
                
                log(`‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á ${currentIndex + 1}/${voices.length}: ${voice.name}`);
                
                const testText = voice.lang.includes('th') ? 
                    `‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ó‡∏µ‡πà ${currentIndex + 1} ${voice.name}` :
                    `Voice ${currentIndex + 1} ${voice.name}`;
                
                const utterance = new SpeechSynthesisUtterance(testText);
                utterance.voice = voice;
                utterance.volume = volume;
                utterance.rate = rate;
                utterance.pitch = pitch;
                
                utterance.onend = () => {
                    currentIndex++;
                    setTimeout(testNext, 1000);
                };
                
                utterance.onerror = () => {
                    log(`‚ùå ‡πÄ‡∏™‡∏µ‡∏¢‡∏á ${voice.name} ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ`);
                    currentIndex++;
                    setTimeout(testNext, 500);
                };
                
                speechSynth.speak(utterance);
            }
            
            testNext();
        }

        function stopSpeaking() {
            log('‚èπÔ∏è ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏π‡∏î');
            speechSynth.cancel();
            currentUtterance = null;
            showStatus('‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏π‡∏î‡πÅ‡∏•‡πâ‡∏ß', 'info');
        }

        function clearLog() {
            logs = [];
            document.getElementById('debug').innerHTML = '=== LOG ===<br>Log ‡∏ñ‡∏π‡∏Å‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß';
            log('Log ‡∏ñ‡∏π‡∏Å‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß');
        }

        // Slider controls
        function updateVolume() {
            const slider = document.getElementById('volumeSlider');
            volume = slider.value / 100;
            document.getElementById('volumeValue').textContent = Math.round(volume * 100) + '%';
            log(`‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á: ${Math.round(volume * 100)}%`);
        }

        function updateRate() {
            const slider = document.getElementById('rateSlider');
            rate = parseFloat(slider.value);
            document.getElementById('rateValue').textContent = rate + 'x';
            log(`‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß: ${rate}x`);
        }

        function updatePitch() {
            const slider = document.getElementById('pitchSlider');
            pitch = parseFloat(slider.value);
            document.getElementById('pitchValue').textContent = pitch;
            log(`‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á: ${pitch}`);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.target.tagName !== 'TEXTAREA' && e.target.tagName !== 'INPUT') {
                if (e.code === 'Space') {
                    e.preventDefault();
                    speakText();
                }
                if (e.key === 'Escape') {
                    stopSpeaking();
                }
            }
        });
    </script>
</body>
</html>